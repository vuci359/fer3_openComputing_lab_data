<!DOCTYPE html>
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="./jquery.dataTables.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="text/javascript" charset="utf8" src="./jquery.dataTables.min.js"></script>
</head>
<body>
    <h1>Datatable</h1>
    <table id="musicData" class="display">
        <thead>
            <tr>
                <th>song name</th>
                <th>band name</th>
                <th>band members</th>
                <th>genre</th>
                <th>album name</th>
                <th>album label</th>
                <th>album release date</th>
                <th>song length</th>
                <th>position on album</th>
                <th>lyrics writers</th>
                <th>music writers</th>
                <th>lyrics</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Row 1 Data 1</td>
                <td>Row 1 Data 2</td>
            </tr>
            <tr>
                <td>Row 2 Data 1</td>
                <td>Row 2 Data 2</td>
            </tr>
        </tbody>
    </table>
</body>


<script>
var json_data = null;


//punjenje tablice
function fill_table(){
    //uƒçitavanje podataka
    getData();
    //punjenje tablice
    $('#example').dataTable( {
        "data": json_data,
        "columns": [
            { "data": "song name" },
            { "data": "band name" },
            { "data": "band members" },
            { "data": "genre" },
            { "data": "album name" },
            { "data": "album label" },
            { "data": "album release date" },
            { "data": "song length" },
            { "data": "position on album" },
            { "data": "lyrics writers" },
            { "data": "music writers" },
            { "data": "lyrics" }
        ]
    } );
}


//filtriranje
//var table2 = $('#example').DataTable();
 
//table.columns().flatten().each( function ( colIdx ) {
    // Create the select list and search operation
  //  var select = $('<select />')
 //       .appendTo(
 //           table2.column(colIdx).footer()
  //      )
 //       .on( 'change', function () {
  //          table2
  //              .column( colIdx )
 //               .search( $(this).val() )
 //               .draw();
 //       } );
 
    // Get the search data for the first column and add to the select list
 //   table2
 //       .column( colIdx )
  //      .cache( 'search' )
 //       .sort()
  //      .unique()
 //       .each( function ( d ) {
 //           select.append( $('<option value="'+d+'">'+d+'</option>') );
 //       } );


// output: {"success":"true"}
function getData(){
      
         return fetch('http://localhost:5000' + '/api/HeavyMetalData/GetData',{
            method: 'GET',
            mode:'cors',
            data: jQuery.param({stupac:"*", parameter:"*"}),
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8'
        }).then(response => {
             if (response.status >= 200 && response.status < 300) {
                console.log("aaa");
                console.log(response.body);
                console.log("bbb");
                return response;
            } else {
                console.log('Something happened wrong');
                console.log(response.body);
               }
         }).then(res => res.json()).then(data => {
                console.log("zzz");
                console.log(data);
                json_data = data;
         }).catch(err => err);
}
        


</script>